# 重要性采样   

## 1.重要性采样  

  一种用来估计复杂分布下期望值的方法，核心思想是用一个容易采样的分布来代替目标分布来采样，通过加权来修正这种代替带来的偏差  

## 2.步骤
（1）选一个容易采样的分布q(x)，叫提议分布  
（2）从q(x)里面采样很多样本  
（3）给每个样本加权，权重是p(x)/q(x)，其中p(x)是想要计算的目标分布  
## 3、公式
重要性采样的期望估计公式是：
![image](https://github.com/user-attachments/assets/c35797c7-8ce1-4f66-ad57-9425429aac65)
在这个公式中，我们想要计算复杂分布p(x)下f(x)的期望，如果p(x)如果比较复杂或者无法直接采样，那么就可以引入一个易于采样的q(x)，通过q(x)采样来估计  
<div align=center>
  <img src="https://github.com/user-attachments/assets/6d56741e-a9e7-4f21-a244-0773d34c61c3" width="500" />
</div>
其中xi~q(x)，即从简单分布采样得来，w(xi) = p(xi)/q(xi)被称为重要性权重
